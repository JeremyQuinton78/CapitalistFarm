<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>CapitalistFarm</title>
    <style>
        body{
            background-color : #444444;
            color : white;
        }
    </style>
</head>
<body>

    <div id="now"></div>
    <div id="score"></div>
    <div id="speed"></div>
    <div id="buttons"></div>

    <script>

        var d = new Date();
        var timeStart = d.getTime(); // définition du temps de départ en timestamp.

        var hours;
        var minutes;
        var seconds;
        var TimeStamp; // Heure actuel en timestamp.
        var profit; // écart entre maintenant et le temps de départ.
        var delay = 1000; // Délai avant que le profit impact le score
        var score = 0; 
        var displayScore; // L'affichage du score.
        var btnOn = false; // "True" si le bouton est présent
        var bonus; // De combien sera la bonus.
        
        function loop() {
                
            d = new Date();
            hours = d.getHours();
            minutes = d.getMinutes();
            seconds = d.getSeconds();
            TimeStamp = d.getTime();

            if (hours < 10) { hours = "0" + hours; }
            if (minutes < 10) { minutes = "0" + minutes; }
            if (seconds < 10) { seconds = "0" + seconds; }
            document.getElementById("now").innerHTML = hours + " : " + minutes + " : " + seconds;

            if (delay > 0) { profit = (TimeStamp - timeStart) / delay; }
            if (delay == 0) { profit = TimeStamp - timeStart }
            if (delay < 0) { profit = (TimeStamp - timeStart) * -delay; }
           
            score = Math.round(score + profit);

            if (score <= 1000) { displayScore = score + " $"; }
            if (score >= 1000) { displayScore = (score / 1000) + " K $"; }
            if (score >= 1000000) { displayScore = (score / 1000000) + " M $"; }
            if (score >= 1000000000) { displayScore = (score / 1000000000) + " B $"; }
            if (score >= 1000000000000) { displayScore = (score / 1000000000000) + " T $"; }
            if (score >= 1000000000000000) { displayScore = (score / 1000000000000000) + " Q $"; }

            document.getElementById("score").innerHTML = displayScore;
            document.getElementById("speed").innerHTML = "Speed : " + (1000 - delay);

            if (seconds == 0 && btnOn == false) {
                var btn = document.createElement("button");
                var MoreOrFaster = Math.floor(Math.random() * Math.floor(2)); 

                if (minutes == 00 || minutes == 30) {
                    bonus = 50 + Math.floor(Math.random() * Math.floor(50));
                }
                else if (minutes == 15 || minutes == 45) {
                    bonus = 35 + Math.floor(Math.random() * Math.floor(15));
                }
                else if (minutes == 10 || minutes == 20 || minutes == 40 || minutes == 50) {
                    bonus = 20 + Math.floor(Math.random() * Math.floor(15));
                }
                else if (minutes == 25 || minutes == 35 || minutes == 55) {
                    bonus = 10 + Math.floor(Math.random() * Math.floor(10));
                }
                else {
                    bonus = 1 + Math.floor(Math.random() * Math.floor(10));
                }

                if (MoreOrFaster == 0) {
                    btn.appendChild(document.createTextNode("+" + bonus + "%"));
                    btn.addEventListener("click", more);
                }
                else {
                    btn.appendChild(document.createTextNode("+" + 2 * bonus + " speed pt"));
                    btn.addEventListener("click", faster);
                }

                document.getElementById("buttons").appendChild(btn);
                btnOn = true;
            }
            setTimeout(loop, 100);
        }
        loop();

        function more() {
            if (seconds != 0) {
                score = score + (score / (100 / bonus));
                document.getElementById("buttons").removeChild(buttons.childNodes[0]);
                btnOn = false;
            }
        }

        function faster() {
            if (seconds != 0) {
                delay = delay - 2 * bonus;
                document.getElementById("buttons").removeChild(buttons.childNodes[0]);
                btnOn = false;
            }
        }
    </script>
</body>

